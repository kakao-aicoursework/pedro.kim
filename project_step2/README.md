# 프로젝트 2단계

카카오 싱크에 대해 설명하는 챗봇입니다. LangChain을 활용하여 작성되었습니다.

이 챗봇 스킬 서버는 **mario.h**의 스켈레톤 코드를 기반으로 작성되었습니다.

## 실행 방법

1. <https://chatbot.kakao.com/>에서 채널을 만들고 챗봇을 만듭니다.
2. 이 레포지토리의 FastAPI 서버를 어딘가에 띄웁니다. (예를 들어 `uvicorn main:app`과 같은 명령어로 서버를 띄울 수 있습니다. 당연히 다른 ASGI 서버로도 가능합니다)
3. 챗봇 관리자 센터에서 스킬을 생성하고, 콜백 URL을 2. 에서 띄운 서버의 콜백 엔드포인트를 향하게 합니다.
4. 이제 시나리오 메뉴에서 원하는 시나리오에 해당 스킬을 추가하면 됩니다.
5. AI 챗봇의 경우 5초를 넘으면 타임아웃이 발생하기 때문에, 설정 메뉴의 AI 챗봇 관리 탭에서 AI 챗봇 설정 활성화가 필요합니다.
6. AI 챗봇 설정이 활성화되면 시나리오의 Callback 설정에서 타임아웃을 연장할 수 있습니다.
7. 이제 카카오톡에서 해당 채널을 추가하고 메시지를 보내 테스트하면 됩니다.

## LangChain 구성

```mermaid
    flowchart LR
        id1["유저 입력"]
        id2["메시지 분류 프롬프트"]
        id3(("question"))
        id4(("generic"))
        id5(("deny"))
        id6["문서를 참조하여 질문에 답변"]
        id7["카카오싱크를 권유하는 메시지 출력"]
        id8["요청/질문에 대해 정중히 거절"]
        id1 --> id2
        id2 --> id3
        id2 --> id4
        id2 --> id5
        id3 --> id6
        id4 --> id7
        id5 --> id8
```
